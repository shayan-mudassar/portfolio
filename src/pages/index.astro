---
import MainLayout from "../layouts/MainLayout.astro";
import EventBus from "../components/EventBus.tsx";
import EventLedger from "../components/EventLedger.tsx";
import ArchitectureMap from "../components/ArchitectureMap.tsx";
import ReliabilityScorecard from "../components/ReliabilityScorecard.astro";
import ExperienceTimeline from "../components/ExperienceTimeline.astro";
import SentinelSimulator from "../components/SentinelSimulator.tsx";
import AnomalyExplorer from "../components/AnomalyExplorer.tsx";
import ContactCopy from "../components/ContactCopy.tsx";
import { profile } from "../data/profile";

const description =
  "Senior Full-Stack Engineer in London delivering product-ready, event-driven systems with end-to-end ownership and production readiness.";
const base = import.meta.env.BASE_URL;
const cvUrl = `${base}${profile.cvPath.replace(/^\//, "")}`;
---
<MainLayout title={`${profile.name} | ${profile.role}`} description={description}>
  <section class="section hero" id="home">
    <div class="container hero-grid">
      <div>
        <div class="eyebrow">{profile.positioning}</div>
        <h1>{profile.headline}</h1>
        <p class="hero-lead">{profile.summary}</p>
        <p class="hero-proof">{profile.proofPoints}</p>
        <div class="hero-actions">
          <a class="cta-primary" href={cvUrl} aria-label="View CV PDF">
            View CV
          </a>
          <a class="cta-secondary" href={`mailto:${profile.email}`} aria-label="Contact Shayan via email">
            Contact
          </a>
          <a
            class="cta-secondary"
            href={profile.links.github}
            target="_blank"
            rel="noreferrer"
            aria-label="Shayan Mudassar on GitHub"
          >
            GitHub
          </a>
        </div>
        <EventLedger client:load />
        <div class="hero-meta">
          <span class="pill">{profile.location}</span>
          <span class="pill">{profile.role}</span>
          <span class="pill">Production readiness</span>
        </div>
      </div>
      <div>
        <EventBus client:load />
      </div>
    </div>
  </section>

  <section class="section" id="playground">
    <div class="container">
      <div class="section-header">
        <div>
          <div class="eyebrow">Systems playground</div>
          <h2>Trace the flow, spot the safeguards.</h2>
          <p class="arch-hint">
            Architecture Mode turns the whole site into a diagram-first view and highlights where each project lives.
          </p>
        </div>
        <div class="pill">Ctrl + K for command palette</div>
      </div>
      <div class="playground-grid">
        <div class="surface">
          <div class="eyebrow">Event-driven map</div>
          <h3>Service mesh in miniature</h3>
          <p class="arch-hint">
            API gateways, compute, storage, and queues stitched with observability. Projects attach right where real
            incidents happen.
          </p>
          <ArchitectureMap client:load />
        </div>
        <ReliabilityScorecard />
      </div>
    </div>
  </section>

  <section class="section" id="experience">
    <div class="container">
      <div class="section-header">
        <div>
          <div class="eyebrow">Experience</div>
          <h2>Owning services end-to-end in production.</h2>
        </div>
        <div class="pill">Expandable timeline</div>
      </div>
      <ExperienceTimeline />
    </div>
  </section>

  <section class="section" id="projects">
    <div class="container">
      <div class="section-header">
        <div>
          <div class="eyebrow">Projects</div>
          <h2>Mini case studies with interactive demos.</h2>
          <p class="arch-hint">Each project shows the problem, the engineering approach, and the operational outcome.</p>
        </div>
      </div>
      <div class="projects">
        <SentinelSimulator client:visible />
        <AnomalyExplorer client:visible />
      </div>
    </div>
  </section>

  <section class="section" id="skills">
    <div class="container">
      <div class="section-header">
        <div>
          <div class="eyebrow">Capability map</div>
          <h2>Focused clusters instead of a wall of buzzwords.</h2>
        </div>
      </div>
      <div class="skills-map">
        {profile.skills.map((skill) => (
          <details>
            <summary>{skill.title}</summary>
            <ul>
              {skill.items.map((item) => (
                <li>{item}</li>
              ))}
            </ul>
          </details>
        ))}
      </div>
    </div>
  </section>

  <section class="section" id="certifications">
    <div class="container">
      <div class="section-header">
        <div>
          <div class="eyebrow">Certifications & Education</div>
          <h2>Security and data science grounded in engineering.</h2>
        </div>
      </div>
      <div class="cert-grid">
        {profile.certifications.map((cert) => (
          <div class="cert-card">
            <strong>{cert.title}</strong>
            <div class="arch-hint">{cert.issuer}</div>
          </div>
        ))}
        {profile.education.map((edu) => (
          <div class="cert-card">
            <strong>{edu.title}</strong>
            <div class="arch-hint">{edu.issuer}</div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <section class="section" id="cta">
    <div class="container">
      <div class="cta-card">
        <div>
          <div class="eyebrow">Open to roles</div>
          <h2>Open to roles: Full-Stack / Backend (Product-facing)</h2>
          <p class="arch-hint">{profile.workPreference}</p>
        </div>
        <div class="cta-actions">
          <a class="cta-primary" href={cvUrl} aria-label="Download CV PDF">
            Download CV
          </a>
          <a class="cta-secondary" href={`mailto:${profile.email}`} aria-label="Email Shayan Mudassar">
            Email me
          </a>
        </div>
      </div>
    </div>
  </section>

  <section class="section" id="contact">
    <div class="container">
      <div class="section-header">
        <div>
          <div class="eyebrow">Contact</div>
          <h2>Let's talk about product-facing systems.</h2>
          <p class="arch-hint">Copy the email or open your mail client.</p>
        </div>
      </div>
      <ContactCopy client:visible email={profile.email} />
    </div>
  </section>
</MainLayout>
